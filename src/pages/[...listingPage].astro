---
import ListingPageDetail from '@components/ListingPageDetail.astro'
import { Icon } from 'astro-icon/components'
import Layout from '@layouts/Default.astro'
import Section from '@components/Section.astro'
import PropertySearch from '@components/ui/PropertySearch.astro'
import listings from './api/gapi';

export function getStaticPaths() {
  const paths = listings.map((listings) => ({
    params: {
      listingPage: listings._id // Ensure this matches the requested path
    },
    props: {
      title: listings.title,
      PropertyType: listings.propertyType,
      bathrooms: listings.bathrooms,
      pictures: listings.pictures,
      beds: listings.beds,
      description: listings.publicDescription
    }
  }));

  console.log("Generated paths:", JSON.stringify(paths, null, 2)); // Log the generated paths

  return paths; // Return the array of paths directly
}

export async function get({ params }) {
  const listing = listings.find((listing) => listing._id === params.listingPage);

  if (!listing) {
    return {
      status: 404,
      body: 'Not Found'
    };
  }

  return {
    lineListing: listings,
    id: listings._id,
  title: listings.title,
  city: listings.address.city,
  state: listings.address.state,
  description: listings.publicDescription.summary,
  PropertyType: listings.propertyType,
  bathrooms: listings.bathrooms,
  pictures: listings.pictures,
  beds: listings.beds
  };
}

const { title, pictures, description, beds, bathrooms, propertyType } = Astro.props;



---

<ListingPageDetail
          title={title}
          _id={listings._id}
          description={description}
          bathrooms={bathrooms}
          beds={beds}
          pictures={pictures}
        />