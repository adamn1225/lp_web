---
import { processListing } from "../utils/utils.ts"
import ListingPageDetail from '@components/ListingPageDetail.astro'
import fetchListings from '@/pages/api/fetch-listings.ts';

const allListings = await fetchListings();


export function getStaticPaths() {
// let query = parseInt(allListings.publicDescription);
// let desc = allListings.find((publicDescription: any) => publicDescription === query);
const paths = allListings.map((allListings : any) => ({
params: {
  listingPage: processListing(allListings.title, allListings._id) 
},
props: {
  lineListing: allListings,
  _id: allListings._id,
  title: allListings.title,
  city: allListings.address.city,
  state: allListings.address.state,
  description: allListings.picture.title,
  PropertyType: allListings.propertyType,
  bathrooms: allListings.bathrooms,
  pictures: allListings.pictures,
  beds: allListings.beds
}
}));

return paths;
}
const {description, title, city, state, beds, PropertyType, bathrooms, pictures, _id} = Astro.props;

---

<ListingPageDetail
          title={title}
          _id={_id}
          city={city}
          state={state}
          description={description}
          PropertyType={PropertyType}
          bathrooms={bathrooms}
          pictures={pictures}
          beds={beds}
        />